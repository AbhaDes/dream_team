<!--
Group Name: ERA
Group Members: Abha Deshpande, Emily Kim, Roemie Osias
Github: https://github.com/CSC317-F25/group-project-autuvmn

File: login.html
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login - Dream Team</title>
  <meta name="description" content="Sign in to your Dream Team account">
  <link rel="stylesheet" href="styles.css">
</head>
<body class="page-gradient">
  <div class="min-h-screen flex flex-col items-center justify-center" style="padding: 3rem 1rem;">
    <!-- Logo -->
    <a href="index.html" class="logo" style="margin-bottom: 3rem;">
      <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" class="glow-lime" style="color: var(--lime);">
        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
      </svg>
      <span class="text-foreground font-bold text-2xl">Dream Team</span>
    </a>

    <!-- Heading -->
    <h1 class="text-4xl font-extrabold italic text-lime" style="margin-bottom: 0.75rem;">Welcome Back</h1>
    <p class="text-muted-foreground" style="margin-bottom: 2.5rem;">Sign in to continue building dream teams</p>

    <!-- Form Card -->
    <div class="card" style="width: 100%; max-width: 28rem;">
      <form id="loginForm">
        <!-- Email Input -->
        <div class="input-with-icon" style="margin-bottom: 1.25rem;">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
            <polyline points="22,6 12,13 2,6"></polyline>
          </svg>
          <input type="email" id="emailForm" class="input" placeholder="Email Address" required style="height: 3.5rem;">
        </div>
        <!-- Password Input -->
        <div class="input-with-icon" style="margin-bottom: 1.25rem;">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
          </svg>
          <input type="password" id="passwordForm" class="input" placeholder="Password" required style="height: 3.5rem;">
        </div>
        <!-- Forgot Password -->
        <div class="text-right" style="margin-bottom: 1.25rem;">
          <a href="#" class="text-violet text-sm font-medium">Forgot Password?</a>
        </div>
        <!-- Sign In Button -->
        <button type="submit" class="btn btn-gradient w-full" style="height: 3.5rem; font-size: 1.125rem;">
          Sign In
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </button>
      </form>
    </div>
    <!-- Sign Up Link -->
    <p class="text-muted-foreground text-sm" style="margin-top: 2rem;">
      Don't have an account? <a href="signup.html" class="text-lime font-medium">Sign Up</a>
    </p>
  </div>
  <script>
    document.getElementById('loginForm').addEventListener("submit", async (e) => {
      e.preventDefault();
      const email = document.getElementById('emailForm').value;
      const password = document.getElementById('passwordForm').value;
      
      try {
          const response = await fetch('/api/auth/login', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ email, password }),
              credentials: 'include'
          });
          
          const data = await response.json();
          
          if (!response.ok) {
              alert(data.error || 'Login failed');
              return;
          }
          
          //Check what the user had already done before logging in. 
          //1. Check if the event-profile is already made 
          //2. Check if matches are selected
          //3. Check if the user has already teamed up to decide where they go after this
          //4. For now, its event-profile.html
          window.location.href = '/event-profile.html';
      } catch (err) {
          console.error('Login error:', err);
          alert('An error occurred while logging in.');
      }
    });
  </script>
</body>
</html>
