<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Create Event - Dream Team</title>
  <meta name="description" content="Create a new hackathon or project event">
  <link rel="stylesheet" href="styles.css">
</head>
<body class="page-gradient">
  <div class="min-h-screen">
    <!-- Navigation -->
    <nav class="navbar">
      <div class="navbar-inner">
        <a href="index.html" class="logo">
          <svg class="logo-icon" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2">
            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
          </svg>
          <span class="logo-text text-foreground">Dream Team</span>
        </a>
        <div class="nav-actions">
          <a href="login.html" class="btn btn-outline">Login</a>
          <a href="signup.html" class="btn btn-primary">Sign Up</a>
        </div>
      </div>
    </nav>

    <main class="container max-w-2xl mx-auto" style="padding: 2rem 1.5rem;">
      <!-- Back Link -->
      <a href="index.html" class="flex items-center gap-2 text-muted-foreground" style="margin-bottom: 3rem;">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
        Back
      </a>

      <!-- Heading -->
      <div class="text-center" style="margin-bottom: 2.5rem;">
        <h1 class="text-4xl font-extrabold italic" style="margin-bottom: 1rem;">
          <span class="text-lime">Create</span>
          <span class="text-foreground">Your Event</span>
          <span class="gradient-text-violet-blue">Arena</span>
        </h1>
        <p class="text-muted-foreground">Set up your hackathon or project event in seconds</p>
      </div>

      <!-- Form -->
      <form id="createEventForm">
        <!-- Event Name -->
        <div class="form-group">
          <label class="form-label">Event Name</label>
          <input type="text" id="eventNameInput" class="form-input" placeholder="e.g., HackMIT 2025, CS101 Final Project" required style="height: 3.5rem;">
        </div>
        <!-- Event Date -->
        <div class="form-group">
          <label class="form-label">Event Date</label>
          <div style="position: relative;">
            <input type="date" id="eventDateInput" class="form-input" required style="height: 3.5rem;">
            <svg style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); pointer-events: none; color: var(--muted-foreground);" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
          </div>
        </div>
        <!-- Description -->
        <div class="form-group">
          <label class="form-label">Description (Optional)</label>
          <textarea id="eventDescriptionInput" class="form-textarea" placeholder="Tell participants what to expect..." rows="4"></textarea>
        </div>
        <!-- Submit Button -->
        <button type="submit" class="btn btn-gradient w-full" style="height: 3.5rem; font-size: 1.125rem; margin-top: 1rem;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 3l1.912 5.813a2 2 0 0 0 1.275 1.275L21 12l-5.813 1.912a2 2 0 0 0-1.275 1.275L12 21l-1.912-5.813a2 2 0 0 0-1.275-1.275L3 12l5.813-1.912a2 2 0 0 0 1.275-1.275L12 3z"></path>
          </svg>
          Generate Event Code
        </button>
      </form>
    </main>
  </div>
  <script>
    // Create Event Form Handler
    document.getElementById('createEventForm')?.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const eventName = document.getElementById('eventNameInput').value.trim();
        const eventDate = document.getElementById('eventDateInput').value;
        const eventDescription = document.getElementById('eventDescriptionInput').value.trim() || '';
        
        if (!eventName || !eventDate) {
            alert('Please fill in all required fields');
            return;
        }
        
        console.log('Creating event:', { eventName, eventDate, eventDescription });
        
        try {
            // UNFINISHED: route does not exist at the moment (/events/create)
            const response = await fetch('/api/events/create', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    event_name: eventName,
                    event_date: eventDate,
                    description: eventDescription
                }),
                credentials: 'include'
            });
            
            const data = await response.json();
            
            if (!response.ok) {
                alert(data.error || 'Failed to create event');
                return;
            }
            
            // Show success message with event code
            alert('Event created successfully! Your event code is: ${data.event_code || data.event_id}');
            
            // Redirect to event dashboard or show event code
            if (data.event_id) {
                window.location.href = 'event-dashboard.html?eventId=${data.event_id}';
            } else {
                window.location.href = 'index.html';
            }
            
        } catch (err) {
            console.error('Create event error:', err);
            alert('An error occurred while creating the event.');
        }
    });
  </script>
</body>
</html>
